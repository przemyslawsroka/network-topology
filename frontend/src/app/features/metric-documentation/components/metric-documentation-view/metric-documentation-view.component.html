<div class="metric-documentation-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Network Topology Metrics Documentation</mat-card-title>
      <mat-card-subtitle>This document outlines the key Google Cloud Monitoring metrics utilized by the Network Topology tool to visualize network traffic, latency, and connectivity across your infrastructure.</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>

      <h2>I. GCE / Infrastructure View Metrics</h2>
      <p>This view provides insights into the network performance of your Compute Engine instances, load balancers, and hybrid connectivity solutions.</p>

      <h3>1. Core VM & Regional Metrics</h3>
      <ul>
        <li><strong>CPU Utilization:</strong> <code>compute.googleapis.com/instance/cpu/utilization</code></li>
        <li><strong>Memory Usage:</strong> <code>agent.googleapis.com/memory/percent_used</code> (requires Ops Agent)</li>
        <li><strong>Disk Usage:</strong> <code>agent.googleapis.com/disk/percent_used</code> (requires Ops Agent)</li>
      </ul>

      <h3>2. VM to VM Connections</h3>
      <p>These metrics track the direct flow of traffic between individual virtual machine instances.</p>
      <ul>
        <li><strong>Average Hourly Throughput (Egress):</strong> <code>networking.googleapis.com/vm_flow/egress_bytes_count</code></li>
        <li><strong>Average Hourly Throughput (Ingress):</strong> <code>networking.googleapis.com/vm_flow/ingress_bytes_count</code></li>
        <li><strong>Latency (Round-Trip Time):</strong> <code>networking.googleapis.com/vm_flow/rtt</code></li>
        <li><strong>Packet Loss:</strong> <code>networking.googleapis.com/vm_flow/packet_loss_count</code></li>
      </ul>

      <h3>3. Client to Load Balancing</h3>
      <p>Metrics for traffic originating from external clients and terminating at Google Cloud Load Balancers.</p>
      
      <h4>a. External Application Load Balancer</h4>
      <ul>
        <li><strong>Traffic (Requests):</strong> <code>loadbalancing.googleapis.com/https/request_bytes_count</code></li>
        <li><strong>Traffic (Responses):</strong> <code>loadbalancing.googleapis.com/https/response_bytes_count</code></li>
        <li><strong>Latency (Frontend RTT):</strong> <code>loadbalancing.googleapis.com/https/frontend_tcp_rtt</code></li>
        <li><strong>Request Count:</strong> <code>loadbalancing.googleapis.com/https/request_count</code></li>
      </ul>

      <h4>b. External Proxy Network Load Balancer</h4>
      <ul>
        <li><strong>Traffic (Egress):</strong> <code>loadbalancing.googleapis.com/tcp_ssl_proxy/egress_bytes_count</code></li>
        <li><strong>Traffic (Ingress):</strong> <code>loadbalancing.googleapis.com/tcp_ssl_proxy/ingress_bytes_count</code></li>
        <li><strong>Open Connections:</strong> <code>loadbalancing.googleapis.com/tcp_ssl_proxy/open_connections</code></li>
      </ul>

      <h4>c. External Passthrough Network Load Balancer</h4>
      <ul>
        <li><strong>Traffic (Egress):</strong> <code>loadbalancing.googleapis.com/l3/external/egress_bytes_count</code></li>
        <li><strong>Traffic (Ingress):</strong> <code>loadbalancing.googleapis.com/l3/external/ingress_bytes_count</code></li>
      </ul>

      <h3>4. Load Balancing to Backends</h3>
      <p>Metrics for traffic between your load balancers and their backend services (e.g., instance groups).</p>

      <h4>a. External Application Load Balancer to Backend</h4>
      <ul>
        <li><strong>Traffic (Requests):</strong> <code>loadbalancing.googleapis.com/https/backend_request_bytes_count</code></li>
        <li><strong>Traffic (Responses):</strong> <code>loadbalancing.googleapis.com/https/backend_response_bytes_count</code></li>
        <li><strong>Latency:</strong> <code>loadbalancing.googleapis.com/https/backend_latencies</code></li>
        <li><strong>Request Count:</strong> <code>loadbalancing.googleapis.com/https/backend_request_count</code></li>
      </ul>

      <h4>b. Internal Passthrough Network Load Balancer to Backend</h4>
      <ul>
        <li><strong>Traffic (Egress):</strong> <code>loadbalancing.googleapis.com/l3/internal/egress_bytes_count</code></li>
        <li><strong>Traffic (Ingress):</strong> <code>loadbalancing.googleapis.com/l3/internal/ingress_bytes_count</code></li>
      </ul>

      <h3>5. Hybrid Connectivity</h3>
      <p>Metrics for traffic between your VPC and on-premises networks.</p>

      <h4>a. VLAN Attachments (Cloud Interconnect)</h4>
      <ul>
        <li><strong>Attachment Traffic (Egress):</strong> <code>interconnect.googleapis.com/network/attachment/egress_bytes_count</code></li>
        <li><strong>Attachment Traffic (Ingress):</strong> <code>interconnect.googleapis.com/network/attachment/ingress_bytes_count</code></li>
        <li><strong>VM to VLAN Traffic (Egress):</strong> <code>networking.googleapis.com/interconnect_attachment/vm/egress_bytes_count</code></li>
        <li><strong>VM to VLAN Traffic (Ingress):</strong> <code>networking.googleapis.com/interconnect_attachment/vm/ingress_bytes_count</code></li>
      </ul>

      <h4>b. VPN Tunnels</h4>
      <ul>
        <li><strong>Tunnel Traffic (Egress):</strong> <code>vpn.googleapis.com/network/egress_bytes_count</code></li>
        <li><strong>Tunnel Traffic (Ingress):</strong> <code>vpn.googleapis.com/network/ingress_bytes_count</code></li>
        <li><strong>VM to VPN Traffic (Egress):</strong> <code>networking.googleapis.com/vpn_tunnel/vm/egress_bytes_count</code></li>
        <li><strong>VM to VPN Traffic (Ingress):</strong> <code>networking.googleapis.com/vpn_tunnel/vm/ingress_bytes_count</code></li>
      </ul>

      <h4>c. Router Appliance</h4>
      <ul>
        <li><strong>VPC to On-premises (Egress):</strong> <code>routerappliance.googleapis.com/gateway/egress_bytes_count</code></li>
        <li><strong>VPC to On-premises (Ingress):</strong> <code>routerappliance.googleapis.com/gateway/ingress_bytes_count</code></li>
        <li><strong>VM to Router (Egress):</strong> <code>routerappliance.googleapis.com/vm/egress_bytes_count</code></li>
        <li><strong>VM to Router (Ingress):</strong> <code>routerappliance.googleapis.com/vm/ingress_bytes_count</code></li>
      </ul>

      <h3>6. Client to Google Services</h3>
      <ul>
        <li><strong>Traffic (Requests):</strong> <code>networking.googleapis.com/google_service/request_bytes_count</code></li>
        <li><strong>Traffic (Responses):</strong> <code>networking.googleapis.com/google_service/response_bytes_count</code></li>
      </ul>

      <mat-divider></mat-divider>

      <h2>II. GKE Topology Metrics</h2>
      <p>These metrics, provided by the Cloud Latency pipeline, offer a granular view of network performance within your GKE clusters.</p>
      
      <h3>1. Pod, Workload, and Namespace Level</h3>
      <ul>
        <li><strong>Monitored Resource:</strong> <code>k8s_pod</code></li>
        <li><strong>Average Throughput (Egress):</strong> <code>networking.googleapis.com/pod_flow/egress_bytes_count</code></li>
        <li><strong>Average Throughput (Ingress):</strong> <code>networking.googleapis.com/pod_flow/ingress_bytes_count</code></li>
        <li><strong>Median Latency (RTT):</strong> <code>networking.googleapis.com/pod_flow/rtt</code></li>
      </ul>

      <h3>2. Node, Node Pool, and Cluster Level</h3>
      <ul>
        <li><strong>Monitored Resource:</strong> <code>k8s_node</code></li>
        <li><strong>Average Throughput (Egress):</strong> <code>networking.googleapis.com/node_flow/egress_bytes_count</code></li>
        <li><strong>Average Throughput (Ingress):</strong> <code>networking.googleapis.com/node_flow/ingress_bytes_count</code></li>
        <li><strong>Median Latency (RTT):</strong> <code>networking.googleapis.com/node_flow/rtt</code></li>
      </ul>

      <mat-divider></mat-divider>

      <h2>III. Network Topology Node Hierarchy</h2>

      <h3>External clients</h3>
      <ul>
        <li>Business region</li>
        <li>Country</li>
      </ul>
      <h3>Load balancers</h3>
      <ul>
        <li>Global external Application Load Balancer</li>
        <li>Global external proxy Network Load Balancer</li>
        <li>External passthrough Network Load Balancer</li>
        <li>Internal passthrough Network Load Balancer</li>
      </ul>
      <h3>Instances</h3>
      <ul>
        <li>Region</li>
        <li>VPC Network</li>
        <li>Subnet</li>
        <li>Zone</li>
        <li>Instance group</li>
        <li>Instance</li>
      </ul>
      <h3>Cloud NAT gateways</h3>
      <ul>
        <li>Region</li>
        <li>VPC Network</li>
        <li>NATs</li>
        <li>Cloud NAT gateway</li>
      </ul>
      <h3>Network peering</h3>
      <ul>
        <li>Peer networks</li>
        <li>Peer network</li>
      </ul>
      <h3>Google services</h3>
      <ul>
        <li>Google service</li>
      </ul>
      <h3>Interconnects</h3>
      <ul>
        <li>Region</li>
        <li>VPC Network</li>
        <li>Interconnects</li>
        <li>Interconnect</li>
        <li>Interconnect Attachment</li>
      </ul>
      <h3>VPNs</h3>
      <ul>
        <li>Region</li>
        <li>VPC Network</li>
        <li>VPNs</li>
        <li>VPN Gateway</li>
        <li>VPN Gateway Interface</li>
        <li>VPN Tunnel</li>
      </ul>
      <h3>On Premises</h3>
      <ul>
        <li>On Premises</li>
        <li>On Premises Peer</li>
      </ul>
      <h3>Router Appliances</h3>
      <ul>
        <li>Region</li>
        <li>VPC Network</li>
        <li>Router Appliances</li>
        <li>Router Appliance</li>
      </ul>

      <h2>IV. Network Topology Edges</h2>
      <table class="mat-table">
        <tr class="mat-header-row">
          <th class="mat-header-cell">Source Entity</th>
          <th class="mat-header-cell">Destination Entity</th>
          <th class="mat-header-cell">Core Metric</th>
          <th class="mat-header-cell">Group By Fields</th>
        </tr>

        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Instance</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_instance_id</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Subnet</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_subnet_name</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Zone</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_zone</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Region</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_region</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Subnet</td>
          <td class="mat-cell">Subnet</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.subnet_name</code>, <code>metric.labels.remote_subnet_name</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Zone</td>
          <td class="mat-cell">Zone</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.zone</code>, <code>metric.labels.remote_zone</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Region</td>
          <td class="mat-cell">Region</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.region</code>, <code>metric.labels.remote_region</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Country</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_country</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">Business Region</td>
          <td class="mat-cell"><code>networking.googleapis.com/vm_flow/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.remote_business_region</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Country</td>
          <td class="mat-cell">Load Balancer</td>
          <td class="mat-cell"><code>loadbalancing.googleapis.com/https/request_bytes_count</code></td>
          <td class="mat-cell"><code>metric.labels.remote_country</code>, <code>resource.labels.forwarding_rule_name</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Load Balancer</td>
          <td class="mat-cell">Instance Group</td>
          <td class="mat-cell"><code>loadbalancing.googleapis.com/https/backend_request_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.backend_name</code>, <code>resource.labels.backend_zone</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">VLAN Attachment</td>
          <td class="mat-cell"><code>networking.googleapis.com/interconnect_attachment/vm/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.attachment_id</code></td>
        </tr>
        <tr class="mat-row">
          <td class="mat-cell">Instance</td>
          <td class="mat-cell">VPN Tunnel</td>
          <td class="mat-cell"><code>networking.googleapis.com/vpn_tunnel/vm/egress_bytes_count</code></td>
          <td class="mat-cell"><code>resource.labels.instance_id</code>, <code>metric.labels.tunnel_id</code></td>
        </tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>


